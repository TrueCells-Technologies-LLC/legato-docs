<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Legato: Component Definition (.cdef) Files</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="fonts.css" rel="stylesheet" type="text/css" />
<link href="legato.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="jquery.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link rel="icon" type="image/png" href="favicon.ico" />
</head>
<body>
<div id="top"><!-- do not remove this div! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo">
    <img alt="Logo" src="legatoLogo.png"/>
    <div id="projectbrief">Simplifying M2M development</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('def_files_cdef.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Component Definition (.cdef) Files </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><code>Component.cdef</code> files can contain these sections:</p>
<p><a class="el" href="def_files_cdef.html#defFilesCdefSources">sources</a> <br/>
 <a class="el" href="def_files_cdef.html#defFilesCdefImport">import</a> <br/>
 <a class="el" href="def_files_cdef.html#defFilesCdefExport">export</a> <br/>
 <a class="el" href="def_files_cdef.html#defFilesCdefFiles">files</a> <br/>
 <a class="el" href="def_files_cdef.html#defFilesCdefRequires">requires</a></p>
<h1><a class="anchor" id="defFilesCdefSources"></a>
sources</h1>
<p>Contains a list of source code files.</p>
<p>One source file must implement a <code>COMPONENT_INIT</code> function called at start-up.</p>
<div class="fragment"><div class="line">sources:</div>
<div class="line"></div>
<div class="line">    foo.c</div>
<div class="line">    bar.c</div>
<div class="line">    init.c      <span class="comment">// This one implements the COMPONENT_INIT</span></div>
</div><!-- fragment --><h1><a class="anchor" id="defFilesCdefImport"></a>
import</h1>
<p>Lists IPC API definitions required by this component from other components.</p>
<p>Each entry in the import list must have an interface definition (.api) file.</p>
<p>Optionally, it may also contain an interface name followed by an equals sign ('=') in front of the <code></code>.api file path. If the interface name is omitted, the name of the <code></code>.api file (minus the ".api" extension) will be used as the name of the interface. All symbols (type names and function names) defined in the <code></code>.api file will be prefixed with this interface name and an underscore.</p>
<div class="fragment"><div class="line"><span class="keyword">import</span>:</div>
<div class="line"></div>
<div class="line">    hello = sample/greet.api    <span class="comment">// Greet() from the API will appear as &quot;hello_Greet()&quot; in my code.</span></div>
<div class="line">    le_cfg.api                  <span class="comment">// The interface name will be &quot;le_cfg&quot;.</span></div>
</div><!-- fragment --><p>The build tools search for the interface definition (.api) file based on the interface search path.</p>
<p>Inside the component’s source code, you can call API functions defined inside the <code></code>.api files. The types and functions defined in the <code></code>.api file will appear inside the component with the interface name (plus an underscore) prepended to them.</p>
<p>For example, if the <code> greet.api </code> file contains a function called <code>Greet()</code>, it will appear inside the component as <code>hello_Greet()</code>. And the <code>StartReadTxn()</code> function declared in <code> le_cfg.api </code> will appear to the component as <code>le_cfg_StartReadTxn()</code>.</p>
<p>In C/C++, source code must #include “interfaces.h” to use the auto-generated function definitions.</p>
<p>Multiple instances of the same API listed in the “import” section must have unique instance names, and will appear as separate functions with different prefixes.</p>
<div class="fragment"><div class="line"><span class="keyword">import</span>:</div>
<div class="line"></div>
<div class="line">    heat = digitalOutput.api   <span class="comment">// This is what we use to turn on and off the heater.</span></div>
<div class="line">    cool = digitalOutput.api   <span class="comment">// This is what we use to turn on and off the cooling (A/C).</span></div>
</div><!-- fragment --><p>If <code> digitalOutput.api </code> defines two functions <code>On()</code> <code>and</code> Off(), then the component’s source code would have four functions available to it: <code>heat_On()</code>, <code>heat_Off()</code>, <code>cool_On()</code>, and <code>cool_Off()</code>.</p>
<h2><a class="anchor" id="defFilesCdefImportOptions"></a>
Options</h2>
<p>Normally, when an API is imported by a component, the component will want to use that API (i.e., call its functions), so the build tools will automatically generate the client-side IPC code for that API and automatically try to connect to the server when the executable is run. There are a couple of options that can be used to suppress this behaviour.</p>
<p>The <b><code></code>[types-only</b>] option tells the build tools the client only wants to use type definitions from the API. When this option is present, the client-side IPC code will not be generated for this API, but the types defined in the API will still be made available to the component (through <code><a class="el" href="interfaces_8h_source.html">interfaces.h</a></code> in C/C++.)</p>
<p>The <b><code></code>[manual-start</b>] option tells the build tools not to automatically connect to this API's server when the process starts. If this option is used, the component can control exactly when it wants to connect to the server by calling the <code>xxxx_ConnectService()</code> function explicitly in the component source code.</p>
<div class="fragment"><div class="line"><span class="keyword">import</span>:</div>
<div class="line"></div>
<div class="line">    foo.api [types-only]        <span class="comment">// Only need typedefs from here.  Don&#39;t need IPC code generated.</span></div>
<div class="line">    bar.api [manual-start]      <span class="comment">// I&#39;ll start this when I&#39;m ready by calling bar_ConnectService().</span></div>
</div><!-- fragment --><h1><a class="anchor" id="defFilesCdefExport"></a>
export</h1>
<p>Lists IPC services provided by this component to other components. Contents use essentially the same syntax as the the <a class="el" href="def_files_cdef.html#defFilesCdefImport">import</a> section, except the options are different.</p>
<div class="fragment"><div class="line">export:</div>
<div class="line"></div>
<div class="line">    greet.api   <span class="comment">// We offer the Greet API to others so they can say “hello” to the world.</span></div>
<div class="line">    heat = digitalOutput.api</div>
<div class="line">    cool = digitalOutput.api</div>
</div><!-- fragment --><p>The component code must implement the functions defined inside the <code></code>.api files.</p>
<p>The function and data type names defined in the <code></code>.api files must be prefixed with the interface name and an underscore.</p>
<p>If <code> greet.api </code> defines a function called <code>Greet()</code>, the source code for the component must implement a function called <code>hello_Greet()</code>.</p>
<p>In C, the source code must #include “interfaces.h” to get the function prototype definitions.</p>
<h2><a class="anchor" id="defFilesCdefExportManualAdvertisement"></a>
[manual-start] option</h2>
<p>The <b><code></code>[manual-start</b>] option tells the build tools not to automatically advertise this API with the Service Directory when the process starts. If this option is used, the component can control exactly when it wants to start offering the service to others by calling the <code>xxxx_AdvertiseService()</code> function explicitly in the component source code when it is ready.</p>
<div class="fragment"><div class="line">export:</div>
<div class="line"></div>
<div class="line">    foo.api [manual-start]</div>
</div><!-- fragment --><h2><a class="anchor" id="defFilesCdefExportAsync"></a>
[async] option</h2>
<p>Often, the server of a service can simply implement the functions as if they were called directly by the client (even though the client may be running inside another process). So, when the client calls an API function, the server's API function gets called, and when the server returns from the function, the function returns in the client process.</p>
<p>However, sometimes the server needs to hold onto the client request and do other things (perhaps handing requests from other clients) before sending a response back to the client and allowing the client to continue. This is called "asynchronous" mode, and it is enabled using the <code> [async] </code> keyword on the end of the <code>export</code> section entry.</p>
<div class="fragment"><div class="line">export:</div>
<div class="line"></div>
<div class="line">    bar.api [async]</div>
</div><!-- fragment --><p>When asynchronous mode is enabled for an interface, the server-side generated code changes as follows:</p>
<ul>
<li>A <code>commandRef</code> parameter is added to the beginning of all the API functions' parameter lists.</li>
<li>The return value is removed from every API function.</li>
<li>A <code>Respond()</code> function is generated for every API function.</li>
</ul>
<p>In async mode, the server responds to the client's call to API function <code>F()</code> by calling the associated <code>FRespond()</code> function.</p>
<p>The <code>Respond</code> functions all take the <code>commandRef</code> as their first parameter. If an API function has a return value, that return value is sent to the client via the second parameter of the <code>Respond</code> function.</p>
<h1><a class="anchor" id="defFilesCdefFiles"></a>
files</h1>
<p>The same as the <a class="el" href="def_files_adef.html#filesAdef">files</a> section in <code></code>.adef files.</p>
<h1><a class="anchor" id="defFilesCdefRequires"></a>
requires</h1>
<p>The <code>requires:</code> section is used to specify things that the component needs from its runtime environment.</p>
<p>Eventually, this will support "file:", "dir:", "lib:", and "api:" subsections, but for now, only "lib:" subsections are supported.</p>
<h2><a class="anchor" id="defFilesCdefRequiresLib"></a>
lib</h2>
<p>The <code>lib:</code> subsection of the <code>requires:</code> section is used to add a required library to a Component.</p>
<p>A required library is a library file that is expected to exist in the target file system (outside the application's sandbox) that the component needs access to at runtime.</p>
<p>Furthermore, this library will be linked with any executable that this component is a part of. The library name is specified without the leading "lib" or the trailing ".so".</p>
<pre class="fragment">requires:

    lib: foo    // I need access to libfoo.so
</pre><hr/>
<p>Copyright (C) Sierra Wireless, Inc. 2014. All rights reserved. Use of this work is subject to license. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
   <div class="footer">
        <div>
            <a href="https://www.sierrawireless.com/">
                <img src="swi-ico-medium.png" width="24" alt="" />
                &nbsp;Sierra Wireless 2014
            </a>
            &nbsp;-&nbsp;
            Generated by Doxygen 1.8.6
        </div>
    </div>
</body>
</html>
