<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Legato: Unit Testing API</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="fonts.css" rel="stylesheet" type="text/css" />
<link href="legato.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="jquery.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

<link rel="icon" type="image/png" href="favicon.ico">
</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo">
    <img alt="Logo" src="legatoLogo.png"/>
    <div id="projectbrief">Wireless M2M smooth and connected</div>
  </td>
  
  
   
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
   
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('c_test.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Unit Testing API </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="el" href="le__test_8h.html">Click here for the API reference documentation.</a></p>
<hr/>
<p><a class="el" href="c_test.html#c_test_modes">Modes of Operation</a> <br/>
 <a class="el" href="c_test.html#c_test_setup">Setting Up the Test Framework</a> <br/>
 <a class="el" href="c_test.html#c_test_testing">Performing Tests</a> <br/>
 <a class="el" href="c_test.html#c_test_result">Test Summary</a> <br/>
 <a class="el" href="c_test.html#c_test_multiProcess">Flexible Test Scenarios</a> <br/>
</p>
<p>Unit testing is an important aspect of a quantifiable quality assurance methodology. Although unit testing requires some extra overhead (the writing of the unit tests) during the development process it can provide enormous benefits during the project life cycle.</p>
<p>One benefit of writing unit tests is that it gets the developer using the interface to the unit they designed. This forces the developer to think about, and hopefully design for, usability of the interface early in the development cycle.</p>
<p>Another major benefit to unit testing is that it provides a documented and verifiable level of correctness for the designed unit. This allows the developer to refactor the code more aggressively and to quickly verify its correctness. Unit tests can also be used to perform regression testing when adding new features.</p>
<p>Despite the benefits of unit testing, unit tests are often omitted because of the initial overhead of writing the tests and the complexity of testing frameworks. Legato's Unit Test Framework is simple to use and very flexible and lightweight consisting of some handy macros.</p>
<h2><a class="anchor" id="c_test_modes"></a>
Modes of Operation</h2>
<p>The Legato Test Framework can run in one of two modes: <b>pass through</b> or <b>exit on failure</b>. In <b>pass through</b> mode all tests are run even if some of the tests fail. Failed tests are counted and reported on completion. <b>Exit on failure</b> mode also runs all tests but exits right away if any tests fail.</p>
<p>Mode selection is done through a command line argument. If the test program is run with the command line argument '-p' or '--pass-through' then <b>pass through</b> mode is selected. If the neither the '-p' or '--pass-through' arguments are present then <b>exit on failure</b> mode is selected.</p>
<h2><a class="anchor" id="c_test_setup"></a>
Setting Up the Test Framework</h2>
<p>To setup the Legato Test Framework, call the <code>LE_TEST_INIT</code> macro, once before any tests are started.</p>
<h2><a class="anchor" id="c_test_testing"></a>
Performing Tests</h2>
<p>To perform tests, call the <code>LE_TEST</code> macro and pass in your test function to LE_TEST as a parameter. The test function must have a bool return type which indicates that the test passed (true) or failed (false).</p>
<p>For example:</p>
<div class="fragment"><pre class="fragment"> <span class="comment">// Returns true if the test passes, otherwise returns false.</span>
 <span class="keywordtype">bool</span> Test1(<span class="keywordtype">void</span>)
 {
     <span class="keywordtype">int</span> expectedValue;

     <span class="comment">// Do some initializations and/or calculations.</span>
     ...

     <span class="comment">// Call one of the unit-under-test&#39;s interface function and check it&#39;s return value against</span>
     <span class="comment">// an expected value that was calculated earlier.</span>
     <span class="keywordflow">return</span> (unitUnderTest_foo() == expectedValue);
 }


 <span class="comment">// Returns true if the test passes, otherwise returns false.</span>
 <span class="keywordtype">bool</span> Test2(<span class="keywordtype">void</span>)
 {
     <span class="keywordtype">int</span> expectedValue;

     <span class="comment">// Do some initializations and/or calculations.</span>
     ...

     <span class="comment">// Call one of the unit-under-test&#39;s interface function and check it&#39;s return value against</span>
     <span class="comment">// an expected value that was calculated earlier.</span>
     <span class="keywordflow">return</span> (unitUnderTest_foo2() == expectedValue);
 }


 <span class="keywordtype">int</span> main (<span class="keywordtype">void</span>)
 {
     <span class="comment">// Setup the Legato Test Framework.</span>
     <a class="code" href="le__test_8h.html#a219d49d27a2a5a1a6dc63f31b0b66c23">LE_TEST_INIT</a>;

     <span class="comment">// Run the tests.</span>
     <a class="code" href="le__test_8h.html#a555300c0c5b3442572fbcafa6dd7994b">LE_TEST</a>(Test1());
     <a class="code" href="le__test_8h.html#a555300c0c5b3442572fbcafa6dd7994b">LE_TEST</a>(Test2());

     <span class="comment">// Exit with the number of failed tests as the exit code.</span>
     <a class="code" href="le__test_8h.html#a6854a523683637eaf983472360d6a275">LE_TEST_SUMMARY</a>;
 }
</pre></div><h2><a class="anchor" id="c_test_result"></a>
Test Summary</h2>
<p>This code sample shows <code>LE_TEST_SUMMARY</code> was called after all tests have been performed. The LE_TEST_SUMMARY macro will cause the process to exit with the number of failed tests as the exit code.</p>
<p>Also, LE_TEST will log an error message if the test fails and will log an info message if the test passes.</p>
<p>If the unit test in the example above was ran in pass through mode and Test1 failed and Test2 passed, the logs will contain the messages:</p>
<div class="fragment"><pre class="fragment">
 =ERR= | Unit Test Failed: 'Test1()'
  INFO | Unit Test Passed: 'Test2()'

  And the return code would be 1.
</pre></div><dl class="note"><dt><b>Note:</b></dt><dd>The log message format depends on the current log settings.</dd></dl>
<h2><a class="anchor" id="c_test_multiProcess"></a>
Flexible Test Scenarios</h2>
<p>The Legato Test Framework is designed to be flexible because developers may find that structuring unit tests as a single thread, multiple threads or multiple processes is more natural for certain unit tests.</p>
<p>For unit tests that have multiple threads run the various tests, the normal testing procedure will work because all the macros in this test framework are thread safe.</p>
<p>For unit tests using multiple processes to run the various tests, the return codes for all processes must be summed to get the total number of test failures. This is easy if the processes all have a common parent.</p>
<p>In the case where multiple processes run the various tests but do not share a common parent, the macro <code>LE_TEST_NUM_FAILURES</code> can be used to get the number of failures in the process and pass this to another process using some other method (ie. sockets, shared memory, etc.).</p>
<hr/>
<p>Copyright (C) Sierra Wireless, Inc. 2013. All rights reserved. Use of this work is subject to license. </p>
</div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div>
  <div id="nav-path" class="navpath">
    <ul>
   <div class="footer">
        <div>
            <a href="https://www.sierrawireless.com/">
                <img src="swi-ico-medium.png" width="24" alt="" />
                &nbsp;Sierra Wireless 2014
            </a>
            &nbsp;-&nbsp;
            Generated by Doxygen 1.7.6.1
        </div>
    </div>
</body>
</html>
