<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Legato: Component Definition .cdef</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="fonts.css" rel="stylesheet" type="text/css" />
<link href="legato.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="jquery.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link rel="icon" type="image/png" href="favicon.ico" />
</head>
<body>
<div id="top"><!-- do not remove this div! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo">
    <img alt="Logo" src="legatoLogo.png"/>
    <div id="projectbrief">Simplifying M2M development</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('def_files_cdef.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Component Definition .cdef </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><code>Component.cdef</code> files can contain these sections:</p>
<h1><a class="anchor" id="defFilesCdefBundles"></a>
Bundles</h1>
<p>Lists additional files or directories to be copied from the build host into the application so they’re available to the app at runtime (e.g., audio files, web pages, executable scripts or programs built using some external build system).</p>
<p>This section is identical to <a class="el" href="def_files_adef.html#bundlesAdef">the section with the same name in the .adef file</a>.</p>
<h1><a class="anchor" id="defFilesCdefCFlags"></a>
C Flags</h1>
<p>Provides a way to specify command-line arguments to pass to the compiler when compiling C source code files.</p>
<p>Flags are separated by whitespace.</p>
<div class="fragment"><div class="line">cflags:</div>
<div class="line">{</div>
<div class="line">    -g -O0</div>
<div class="line">    -DDEBUG=1</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="defFilesCdefCxxFlags"></a>
C++ Flags</h1>
<p>Provides a way to specify command-line arguments to pass to the compiler when compiling C++ source code files.</p>
<p>Flags are separated by whitespace.</p>
<div class="fragment"><div class="line">cxxflags:</div>
<div class="line">{</div>
<div class="line">    -std=c++0x</div>
<div class="line">    -g -O0</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="defFilesCdefLdFlags"></a>
Linker Flags</h1>
<p>Provides a way to specify command-line arguments to pass to the compiler when linking C/C++ object (.o) files together into a component shared library (.so) file.</p>
<p>Flags are separated by whitespace.</p>
<div class="fragment"><div class="line">ldflags:</div>
<div class="line">{</div>
<div class="line">    -Lfoo/bar</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="defFilesCdefProvides"></a>
Provides</h1>
<p>Lists things that this component provides (exports) to other software either inside or outside of the application.</p>
<p>The only subsection supported today is the <code>api</code> subsection.</p>
<h2><a class="anchor" id="defFilesCdefProvidesApi"></a>
API</h2>
<p>Lists IPC services provided by this component to other components.</p>
<p>Contents use the same syntax as the the <a class="el" href="def_files_cdef.html#defFilesCdefRequiresApi">requires: api: section</a>, except the options are different.</p>
<div class="fragment"><div class="line">provides:</div>
<div class="line">{</div>
<div class="line">    api:</div>
<div class="line">    {</div>
<div class="line">        greet.api   <span class="comment">// We offer the Greet API to others so they can say “hello” to the world.</span></div>
<div class="line">        heat = digitalOutput.api</div>
<div class="line">        cool = digitalOutput.api</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line">sources:</div>
<div class="line">{</div>
<div class="line">    greetServer.c</div>
<div class="line">    tempControl.c</div>
<div class="line">}</div>
</div><!-- fragment --><p>The component must implement the API functions being "provided".</p>
<p>In C, the source code must #include “interfaces.h” to get the auto-generated function prototype definitions and type definitions. The function and type names defined in the <code></code>.api files will be prefixed with the interface name and an underscore (much as they are for "required" APIs).</p>
<p>In the above example, if <code> greet.api </code> defines a function called <code>Send()</code>, the C source code for the component (in <code>greetServer.c</code>) must implement a function called <code>greet_Send()</code>.</p>
<h3><a class="anchor" id="defFilesCdefProvidesApiManualStart"></a>
[manual-start] Option</h3>
<p>Normally, to reduce the amount of initialization code a component writer needs to write, the build tools will automatically try to advertise the service when the executable is run. However, sometimes this is not the preferred behaviour.</p>
<p>The <b><code></code>[manual-start</b>] option tells the build tools <b>not</b> to automatically advertise this API with the Service Directory when the process starts. If this option is used, the component can control exactly when it wants to start offering the service to others by calling the <code>xxxx_AdvertiseService()</code> function explicitly in the component source code when it is ready.</p>
<div class="fragment"><div class="line">provides:</div>
<div class="line">{</div>
<div class="line">    api:</div>
<div class="line">    {</div>
<div class="line">        foo.api [manual-start]</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="defFilesCdefProvidesApiAsync"></a>
[async] Option</h3>
<p>Often, the server of a service can simply implement the functions as if they were called directly by the client (even though the client may be running inside another process). So, when the client calls an API function, the server's API function gets called, and when the server returns from the function, the function returns in the client process.</p>
<p>However, sometimes the server needs to hold onto the client request and do other things (perhaps handing requests from other clients in the meantime) before sending a response back to the client and allowing the client to continue. This is called "asynchronous" mode, and it is enabled using the <code> [async] </code> keyword on the end of the <code>api</code> section entry.</p>
<div class="fragment"><div class="line">provides:</div>
<div class="line">{</div>
<div class="line">    api:</div>
<div class="line">    {</div>
<div class="line">        bar.api [async]</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>When asynchronous mode is enabled for a server-side interface, the generated code changes as follows:</p>
<ul>
<li>A <code>commandRef</code> parameter is added to the beginning of all the API functions' parameter lists.</li>
<li>The return value is removed from every API function.</li>
<li>A <code>Respond()</code> function is generated for every API function.</li>
</ul>
<p>In async mode, the server responds to the client's call to API function <code>F()</code> by calling the associated <code>FRespond()</code> function.</p>
<p>The <code>Respond</code> functions all take the <code>commandRef</code> as their first parameter. If an API function has a return value, that return value is sent to the client via the second parameter of the <code>Respond</code> function. Any output parameters defined in the API function are also passed as parameters to the <code>Respond</code> function.</p>
<p>See <a class="el" href="language_independent_a_p_is.html">Language-Independent APIs</a> for more information, or try it and have a look at the generated header files.</p>
<h1><a class="anchor" id="defFilesCdefRequires"></a>
Requires</h1>
<p>The "requires:" section is used to specify things that the component needs from its runtime environment.</p>
<p>It can contain various subsections:</p>
<h2><a class="anchor" id="defFilesCdefRequiresApi"></a>
API</h2>
<p>Lists IPC APIs used by this component.</p>
<p>For example, if my component needs to use the Configuration Data API (defined in le_cfg.api) to read its configuration data:</p>
<div class="fragment"><div class="line">requires:</div>
<div class="line">{</div>
<div class="line">    api:</div>
<div class="line">    {</div>
<div class="line">        le_cfg.api</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>This creates a client-side IPC interface called "le_cfg" on this component, and it makes the functions and data types defined inside <code>le_cfg.api</code> available for use in the component's program code.</p>
<p>The name of the <code></code>.api file (minus the ".api" extension) will be used as the name of the interface, and in C code, the names of functions and data types defined in the <code></code>.api file will be prefixed with the name of the interface (plus an underscore separator).</p>
<div class="fragment"><div class="line">requires:</div>
<div class="line">{</div>
<div class="line">    api:</div>
<div class="line">    {</div>
<div class="line">        print.api <span class="comment">// WriteLine() from the API will appear in my C code as &quot;print_WriteLine()&quot;.</span></div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>To rename the interface, an interface name followed by an equals sign ('=') can be added in front of the <code></code>.api file path.</p>
<div class="fragment"><div class="line">requires:</div>
<div class="line">{</div>
<div class="line">    api:</div>
<div class="line">    {</div>
<div class="line">        hello = greet.api <span class="comment">// Send() from the API will appear as &quot;hello_Send()&quot; in my code.</span></div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>Multiple instances of the same API listed in the <code>api:</code> section must have unique instance names, and will appear as separate functions with different prefixes.</p>
<div class="fragment"><div class="line">requires:</div>
<div class="line">{</div>
<div class="line">    api:</div>
<div class="line">    {</div>
<div class="line">        heat = digitalOutput.api   <span class="comment">// Used to turn on and off the heater.</span></div>
<div class="line">        cool = digitalOutput.api   <span class="comment">// Used to turn on and off the cooling (A/C).</span></div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>If <code> digitalOutput.api </code> defines two functions <code>On()</code> <code>and</code> Off(), then the component’s source code would have four functions available to it: <code>heat_On()</code>, <code>heat_Off()</code>, <code>cool_On()</code>, and <code>cool_Off()</code>.</p>
<p>C/C++ source code must #include “interfaces.h” to use the auto-generated function definitions. The build tools will automatically generate a version of <code>interfaces.h</code> customized for your component that includes all the declarations for all the interfaces that your component uses.</p>
<p>The build tools search for the interface definition (.api) file based on the interface search path.</p>
<h2><a class="anchor" id="defFilesCdefRequiresApiOptions"></a>
Options</h2>
<p>Normally, to reduce the amount of initialization code a component writer needs to write, the build tools will automatically generate the client-side IPC code for that API and automatically try to connect to the server when the executable is run. There are a couple of options that can be used to suppress this behaviour.</p>
<p>The <b><code></code>[types-only</b>] option tells the build tools the client only wants to use type definitions from the API. When this option is present, the client-side IPC code will not be generated for this API, but the types defined in the API will still be made available to the component (through <code>interfaces.h</code> in C/C++.)</p>
<p>The <b><code></code>[manual-start</b>] option tells the build tools not to automatically connect to this API's server when the process starts. If this option is used, the component can control exactly when it wants to connect to the server by calling the <code>xxxx_ConnectService()</code> function explicitly in the component source code.</p>
<div class="fragment"><div class="line">requires:</div>
<div class="line">{</div>
<div class="line">    api:</div>
<div class="line">    {</div>
<div class="line">        foo.api [types-only]    <span class="comment">// Only need typedefs from here.  Don&#39;t need IPC code generated.</span></div>
<div class="line">        bar.api [manual-start]  <span class="comment">// I&#39;ll start this when I&#39;m ready by calling bar_ConnectService().</span></div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="defFilesCdefRequiresFile"></a>
File</h2>
<p>Used to declare that certain files that reside on the target device outside of the application are to be made accessible to the application.</p>
<p>This section is the same as the <a class="el" href="def_files_adef.html#requiresFile">section with the same name in the .adef file</a>.</p>
<h2><a class="anchor" id="defFilesCdefRequiresDir"></a>
Dir</h2>
<p>Used to declare that certain directories that reside on the target device outside of the application are to be made accessible to the application.</p>
<p>This section is the same as the <a class="el" href="def_files_adef.html#requiresDir">section with the same name in the .adef file</a>.</p>
<h2><a class="anchor" id="defFilesCdefRequiresLib"></a>
Lib</h2>
<p>The <code>lib:</code> subsection of the <code>requires:</code> section is used to add a required library to a Component.</p>
<p>A required library is a library file that is expected to exist in the target file system (outside the application's sandbox) that the component needs access to at runtime.</p>
<p>Furthermore, this library will be linked with any executable that this component is a part of. The library name is specified without the leading "lib" or the trailing ".so".</p>
<div class="fragment"><div class="line">requires:</div>
<div class="line">{</div>
<div class="line">    lib:</div>
<div class="line">    {</div>
<div class="line">        foo    <span class="comment">// I need access to libfoo.so</span></div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="defFilesCdefRequiresComponent"></a>
Component</h2>
<p>Declares that this component depends on another component.</p>
<div class="fragment"><div class="line">requires:</div>
<div class="line">{</div>
<div class="line">    component:</div>
<div class="line">    {</div>
<div class="line">        foo</div>
<div class="line">        bar</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>Any application that uses a component will also use any other components that component requires, and any components they require, etc.</p>
<p>Furthermore, specifying a dependency on another component ensures that calls to component initialization functions ( <code>COMPONENT_INIT</code> in C/C++ components ) will be sorted in the correct order. If component A depends on component B, then component B will be initialized first.</p>
<p>Dependency loops are not allowed. That is, a component C cannot depend on another component that (either directly or indirectly) depends on component C. The build tools will detect dependency loops and report an error.</p>
<h1><a class="anchor" id="defFilesCdefSources"></a>
Sources</h1>
<p>Contains a list of source code files.</p>
<p>If C or C++ code, one source file must implement a <code>COMPONENT_INIT</code> function. The framework will automatically call that function at start-up.</p>
<div class="fragment"><div class="line">sources:</div>
<div class="line">{</div>
<div class="line">    foo.c</div>
<div class="line">    bar.c</div>
<div class="line">    init.c      <span class="comment">// This one implements the COMPONENT_INIT</span></div>
<div class="line">}</div>
</div><!-- fragment --><hr/>
<p>Copyright (C) Sierra Wireless, Inc. 2014. Use of this work is subject to license. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
   <div class="footer">
        <div>
            <a href="https://www.sierrawireless.com/">
                <img src="swi-ico-medium.png" width="24" alt="" />
                &nbsp;Sierra Wireless 2014
            </a>
            &nbsp;-&nbsp;
            Generated by Doxygen 1.8.6
        </div>
    </div>
</body>
</html>
