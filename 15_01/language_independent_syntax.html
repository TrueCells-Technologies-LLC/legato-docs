<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>LEGATO: API Definition Syntax</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="fonts.css" rel="stylesheet" type="text/css" />
<link href="legato.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="jquery.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link rel="icon" type="image/png" href="favicon.ico" />
</head>
<body>
<div id="top"><!-- do not remove this div! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo">
    <img alt="Logo" src="legatoLogo.png"/>
    <div id="projectbrief">Simplifying IoT development</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('language_independent_syntax.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">API Definition Syntax </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The API file supports defining functions, events, handlers and user defined types. Functions are similar to C functions. They can take input and output parameters, and can return a result. An event is similar to a function and is used for registering handlers/callbacks, which are called when the corresponding event occurs. A handler defines a handler/callback function, which can be used with functions and events. The API file currently supports a limited number of pre-defined types. There is also support for a number of different user-defined types.</p>
<h1><a class="anchor" id="languageIndependentSyntax_types"></a>
Type Support</h1>
<p>The API file currently supports a limited number of pre-defined types. These are:</p>
<pre class="fragment">uint8
uint16
uint32
uint64

int8
int16
int32
int64

string
file
handler
</pre><p>The unsigned and signed integer types are self-explanatory. See <a class="el" href="language_independent_syntax.html#languageIndependentSyntax_function">Specifying a Function</a> for details on the <code>string</code> type. The <code>file</code> type is used to pass an open file descriptor (fd) as a parameter. This is used for passing an fd between a client and server. The <code>handler</code> type is used for passing a handler as a parameter.</p>
<p>The following user-defined types are supported:</p>
<ul>
<li>DEFINE</li>
<li>ENUM</li>
<li>BITMAP</li>
<li>REFERENCE</li>
</ul>
<p>Type definitions can also be shared between API files with USETYPES.</p>
<p>Also, all C types defined in the <code><a class="el" href="legato_8h.html">legato.h</a></code> file are available. The most commonly used of these is the <a class="el" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86c">le_result_t</a> type. Support for directly using these C types is a temporary measure and will be removed in a future release.</p>
<h2><a class="anchor" id="languageIndependentSyntax_typesDefine"></a>
DEFINE</h2>
<p>A DEFINE is specified as:</p>
<pre class="fragment">DEFINE &lt;name&gt; = &lt;value&gt;;
</pre><p>The <code>value</code> can be a string or an expression evaluated to a numeric value (when the definition is read).</p>
<h2><a class="anchor" id="languageIndependentSyntax_typesEnum"></a>
ENUM</h2>
<p>An ENUM is specified as:</p>
<pre class="fragment">ENUM &lt;name&gt;
{
    [&lt;elementList&gt;]
};
</pre><p>The <code>elementList</code> is a comma separated list of elements. The elements should all be uppper-case. Element values assigned are internally generated and can't be explicitly given.</p>
<h2><a class="anchor" id="languageIndependentSyntax_typesBitmask"></a>
BITMASK</h2>
<p>A BITMASK is a special type of ENUM. It is specified the same way as an ENUM, but the internally generated element values are bit positions, i.e. 0x1, 0x2, 0x4, etc.</p>
<h2><a class="anchor" id="languageIndependentSyntax_typesReference"></a>
REFERENCE</h2>
<p>A REFERENCE is specified as:</p>
<pre class="fragment">REFERENCE &lt;name&gt;;
</pre><p>The REFERENCE is used to define a reference to an object. The object reference is mapped to an opaque reference in C and an object instance or similar in other languages.</p>
<h2><a class="anchor" id="languageIndependentSyntax_typesUsetypes"></a>
USETYPES</h2>
<p>You can share type definitions between .api files with USETYPES. This is commonly referred to as importing, although only the type definitions are imported or used. Any code related definitions in a .api file, e.g. FUNCTION, are ignored. These USETYPES can even be nested.</p>
<p>As an example of usage, suppose the files defs.api, common.api and example.api are defined as follows:</p>
<p>defs.api </p>
<pre class="fragment">DEFINE FIVE = 5;
</pre><p>common.api </p>
<pre class="fragment">USETYPES defs.api;

DEFINE TEN = defs.FIVE + 5;
</pre><p>example.api </p>
<pre class="fragment">USETYPES common.api;

DEFINE twenty = common.TEN + defs.FIVE + 5;
</pre><p>This example illustrates that nesting causes an implicit USETYPES. Thus, any definitions from defs.api, can be used in example.api, in the same way as if it had explicitly imported defs.api.</p>
<h1><a class="anchor" id="languageIndependentSyntax_function"></a>
Specifying a Function</h1>
<p>A function is specified as:</p>
<pre class="fragment">FUNCTION [&lt;returnType&gt;] &lt;name&gt;
(
    [&lt;parameterList&gt;]
);
</pre><p>The <code>parameterList</code> can contain one or more parameters separated by commas, or can be empty if there are no parameters. The scalar type refers to anything that's not an array or string (i.e. scalar types do not have a length). These parameters types are supported:</p>
<ul>
<li><code> &lt;type&gt; &lt;name&gt; [ ( "IN" | "OUT" ) ]</code><ul>
<li>scalar type</li>
<li>defaults to IN if a direction is not specified</li>
</ul>
</li>
<li><code> &lt;type&gt; &lt;name&gt; "[" [ &lt;minSize&gt; ".." ] &lt;maxSize&gt; "]" "IN" </code><ul>
<li>an IN array</li>
<li><code>maxSize</code> specifies the maximum number of elements allowed for the array</li>
<li>optional <code>minSize</code> specifies the minimum number of elements required for the array</li>
</ul>
</li>
<li><code> &lt;type&gt; &lt;name&gt; "[" &lt;minSize&gt; "]" "OUT" </code><ul>
<li>an OUT array</li>
<li>array should be large enough to store <code>minSize</code> elements; if supported by the function implemention, a shorter OUT array can be used.</li>
</ul>
</li>
<li><code> "string" &lt;name&gt; "[" [ &lt;minSize&gt; ".." ] &lt;maxSize&gt; "]" "IN" </code><ul>
<li>an IN string</li>
<li><code>maxSize</code> specifies the maximum string length allowed,</li>
<li>optional <code>minSize</code> specifies the minimum string length required</li>
<li>string length is given as number of characters, excluding any terminating characters</li>
</ul>
</li>
<li><code> "string" &lt;name&gt; "[" &lt;minSize&gt; "]" "OUT" </code><ul>
<li>an OUT string</li>
<li>string should be large enough to store <code>minSize</code> characters; if supported by the function implemention, a shorter OUT string can be used.</li>
<li>string length is given as number of characters, excluding any terminating characters</li>
</ul>
</li>
</ul>
<p>The <code>returnType</code> is optional, and if specified, must be a scalar type as described above.</p>
<p>The <code>handler</code> type is treated a little differently than other scalar types. In this case, the <code>name</code> is that of an already defined handler. See <a class="el" href="language_independent_syntax.html#languageIndependentSyntax_handler">Specifying a Handler</a> for details.</p>
<h1><a class="anchor" id="languageIndependentSyntax_event"></a>
Specifying an Event</h1>
<p>Do this to specify an event:</p>
<pre class="fragment">EVENT &lt;eventType&gt;
(
    &lt;parameterList&gt;
);
</pre><p>The <code>parameterList</code> can contain one or more parameters separated by commas. It can contain anything that's valid for a function, but it must contain one handler parameter. The parameters are used when registering a handler for the specified event.</p>
<p>See <a class="el" href="language_independent_c.html#languageIndependentC_event">Events in C</a> for details on the C code generated from the above event definition.</p>
<h1><a class="anchor" id="languageIndependentSyntax_handler"></a>
Specifying a Handler</h1>
<p>Do this to specify a handler:</p>
<pre class="fragment">HANDLER &lt;handlerType&gt;
(
    [&lt;parameterList&gt;]
);
</pre><p>The <code>parameterList</code> can contain one or more parameters separated by commas, or can be empty if there are no parameters. It can only contain scalar types, as described above for <a class="el" href="language_independent_syntax.html#languageIndependentSyntax_function">Specifying a Function</a>. All the parameters should be IN parameters.</p>
<p>See <a class="el" href="language_independent_c.html#languageIndependentC_handler">Handlers in C</a> for details on the C code generated from the above handler definition.</p>
<h1><a class="anchor" id="languageIndependentSyntax_comments"></a>
Comments</h1>
<p>The API file supports both C and C++ comment styles. Comments that use the doxygen formats </p>
<pre class="fragment">/** </pre><p> to start a multi-line comment or</p>
<pre class="fragment">///&lt; </pre><p> to start a one line comment receive special processing. Multi-line comments at the start of the API file will be copied directly to the start of the appropriate generated files.</p>
<p>Comments given in the function definition will be copied to the appropriate generated files under the following conditions:</p>
<ul>
<li>Multi-line comments must start with<pre class="fragment">/** </pre></li>
<li>Single-line comments must start with<pre class="fragment">///&lt; </pre></li>
<li>In a block of single-line comments, each line must start with<pre class="fragment">///&lt; </pre> rather than just the first line. This is different from typical doxygen usage.</li>
<li>If the function definition is preceded by a multi-line comment then this comment will be copied to the appropriate generated files.</li>
<li>If any parameter is followed by a multi-line comment or one or more single line comments, then all these comments will be copied to the appropriate generated files.</li>
</ul>
<p>If an event or handler definition is preceded by a multi-line comment, then this comment will be copied to the appropriate generated files, under the same conditions as function definitions.</p>
<p>Any comments provided after an element in an ENUM or BITMASK, will be copied to the appropriate generated files, under the same conditions as function parameter comments.</p>
<h1><a class="anchor" id="languageIndependentSyntax_sample"></a>
Sample API</h1>
<p>Here's the <code>defn.api</code> file containing just type defintions</p>
<pre class="fragment">/**
 * Example of nested .api file
 */

DEFINE SIX = 6;
</pre><p>Here's the <code>common.api</code> file containing just type defintions, and using the types defined in <code>defn.api</code> </p>
<pre class="fragment">/**
 * Common definitions potentially used across multiple .api files
 */

USETYPES defn;


/**
 * Definition example
 */
DEFINE FOUR = 4;

/**
 * Example of using previously DEFINEd symbol within an imported file.
 */
DEFINE TEN = FOUR + defn.SIX;

/**
 * Reference example
 */
REFERENCE OpaqueReference;

/**
 * ENUM example
 */
ENUM EnumExample
{
    ZERO,     ///&lt; first enum
    ONE,      ///&lt; second enum
    TWO,      ///&lt; third enum
    THREE     ///&lt; fourth enum
};

/**
 * BITMASK example
 */
BITMASK BitMaskExample
{
    BIT0,     ///&lt; first
    BIT1,     ///&lt; second
    BIT2,     ///&lt; third
};


</pre><p>Here's the <code>example.api</code> file containing various definitions, and using the types defined in <code>defn.api</code> and <code>common.api</code> </p>
<pre class="fragment">/**
 * Example API file
 */

// The .api suffix is optional
USETYPES defn;
USETYPES common.api;


DEFINE TEN = common.FOUR + defn.SIX;
DEFINE TWENTY = TEN + common.TEN;
DEFINE SOME_STRING = "some string";


/**
 * Handler definition
 */
HANDLER TestA
{
    ADD_HANDLER_PARAMS ();

    HANDLER_PARAMS
    (
        int32 x   ///&lt; First parameter for the handler
                  ///&lt; Second comment line
    );
};


/**
 * Function takes all the possible kinds of parameters, but returns nothing
 */
FUNCTION allParameters
(
    common.EnumExample a,  ///&lt; first one-line comment
                           ///&lt; second one-line comment
    uint32 b OUT,
    uint32 data[common.TEN] IN,

    uint32 output[TEN] OUT,   ///&lt; some more comments here
    ///&lt; and some comments here as well

    string label [common.TEN..20] IN,
    string response [TWENTY] OUT
    ///&lt; comments on final parameter, first line
    ///&lt; and more comments
);


/**
 * Test file descriptors as IN and OUT parameters
 */
FUNCTION FileTest
(
    file dataFile IN,   ///&lt; file descriptor as IN parameter
    file dataOut OUT    ///&lt; file descriptor as OUT parameter
);
</pre><hr/>
<p>Copyright (C) 2015 Sierra Wireless, Inc. Use of this work is subject to license. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
   <div class="footer">
        <div>
            <a href="https://www.sierrawireless.com/">
                <img src="swi-ico-medium.png" width="24" alt="" />
                &nbsp;Sierra Wireless
            </a>
            &nbsp;-&nbsp;
            Generated by Doxygen 1.8.6
        </div>
    </div>
</body>
</html>
